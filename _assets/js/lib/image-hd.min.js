/* 

= = = = = = = = = = = = = =
= ABOUT = = = = = = = = = =
= = = = = = = = = = = = = =

SCRIPT : image-hd.js

NAME : Image HD

DESCRIPTION: Javascript library for working with hi-res images (retina, hdpi, etc.)

AUTHORS :
- Jesse Weed

= = = = = = = = = = = = = =
= = = = = = = = = = = = = =


*//*jslint browser: true*/// = = = = = = = = = = = = =
// 1. CONFIGURATION OPTIONS
// = = = = = = = = = = = = =
var ImageHD={class_name:!1,method:"auto",set_dimensions:!0,android_dir_append:"",ios_dir_append:"",retina_prexix:"@2x",android:{xhdpi:!1,hdpi:!1,mdpi:!1,ldpi:!1},retina_droid:!0,autoload:!1,debug:!1,bg_img:!0,bg_img_class:"hd-bg"};ImageHD.density=function(){"use strict";var e=this.platform(),t="standard",n=window.devicePixelRatio;if(e==="android"&&this.retina_droid===!1){this.method==="auto"&&(this.method="dir");n>1.5?t="xhdpi":n===1.5?t="hdpi":n===1?t="mdpi":n===.75&&(t="ldpi")}else if(e==="ios"||e==="mac"||this.retina_droid===!0){this.method==="auto"&&(this.method="append");n>1&&(t="retina")}this.debug===!0&&this.log("current device density: "+t);return t};ImageHD.log=function(e){"use strict";typeof console!="undefined"&&console.log(e)};ImageHD.platform=function(){"use strict";var e=navigator.userAgent.toLowerCase(),t=navigator.platform.toLowerCase(),n=e.match(/ip(?:ad|od|hone)/)?"ios":(e.match(/(?:webos|android)/)||t.match(/mac|win|linux/)||["other"])[0];this.debug===!0&&this.log("platform: "+n);return n};ImageHD.load=function(){"use strict";var e,t,n,r,i,s=0,o,u,a,f,l=this.type(),c=this.density(),h=this.platform();if(c!=="standard"){this.class_name===!1?e=document.getElementsByTagName("img"):e=document.getElementsByClassName(this.class_name);for(s=0;e.length>s;s+=1){t=e[s];n=t.src;r=t.src.split("/").pop();i=n.split(".").pop();this.method==="dir"&&(u=n.split(r).join(l+"/"+r));this.method==="append"&&(u=n.split("."+i).join(l+"."+i));if(u!==null&&u!=="undefined"){a=e[s].width;f=e[s].height;if(this.set_dimensions===!0){e[s].width=a;e[s].height=f}e[s].src=u;this.debug===!0&&this.log(n+" replaced with "+u)}}this.bg_img===!0&&this.setBackground()}};ImageHD.setBackground=function(){"use strict";var e,t,n,r,i,s=0,o,u,a,f,l,c,h,p=this.type(),d=this.density(),v=this.platform();e=document.getElementsByClassName(this.bg_img_class);for(s=0;e.length>s;s+=1){l=e[s];c=window.getComputedStyle(l);h=c.getPropertyValue("background-image");a=c.getPropertyValue("width");f=c.getPropertyValue("height");r=h.split("/").pop();r=r.split(")");r=r[0];i=h.split(".").pop();i=i.split(")");i=i[0];this.method==="dir"&&(u=h.split(r).join(p+"/"+r));this.method==="append"&&(u=h.split("."+i).join(p+"."+i));if(u!==null&&u!=="undefined"){e[s].setAttribute("style","background-image: "+u+"; background-size: "+a+" "+f+";");this.debug===!0&&this.log(h+" replaced with "+u)}}};ImageHD.type=function(){"use strict";var e=this.density(),t=this.platform(),n=null;if(t==="android"){this.method==="auto"&&(this.method="dir");n=this.android_dir_append+e}else if(t==="ios"||t==="mac"){n=this.ios_dir_append+this.method;this.method==="auto"&&(this.method="append");n=this.retina_prexix}return n};ImageHD.autoload===!0&&(window.onload=function(){"use strict";ImageHD.run()});